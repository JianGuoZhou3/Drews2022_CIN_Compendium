# README Signature Generation
# README Signature Discovery

For generating signatures from the data, you will need to apply SignatureAnalyzer-GPU on the CxS (Component by Sample matrix) files. 

## Generate CxS files
The CxS files are generated by running the script `EDF_6_Data_preparation_Signature_activities_from_CN_profiles.R`. This script extracts copy number features from the copy number profiles, calculates the posterior probabilities of belonging to the 43 feature components and adds all values together for each sample. The resulting matrix is a 43 (components) by 6,335 samples matrix and is the input to the NMF. 

The script runs out of the box and does not need any additional input, just load the script into your RStudio and run it.

## Generate signatures 
Once the CxS files are generated, you will need to run two scripts as detailed in the [Signature Discovery repository](https://github.com/markowetzlab/SignatureDiscovery). 

The first script, runs SignatureAnalyzer-GPU 200 times on the CxS files. The second script allows you to identify and extract the optimal solution. The readme as well as the Supplementary Information will tell you step by step how to identify the best solution. 

## Reproduce the figures from the paper
The folder `input/Definitions` already contains the optimal signatures derived from the CxS input files. You just need to run the script `EDF_6_bottomrow_and_SuppFig_33_c_f_Definition_Comparison.R` in RStudio and it will source the already produced signature and plot the figures as found in the publication. This script also allows you to identify which signature solutions is coming from which input data.

